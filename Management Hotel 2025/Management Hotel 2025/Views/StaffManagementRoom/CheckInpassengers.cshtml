
@{
    Layout = null;
}
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Check-in - Khách sạn 5 sao (Full Width & Height)</title>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Inline custom CSS (full-viewport layout) with emphasized headings -->
    <style>
        /* Ensure the page fills the viewport */
        html, body {
            height: 100%;
            width: 100%;
            margin: 0;
        }

        body {
            font-family: "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(180deg, #f3f6fb 0%, #ffffff 100%);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow: hidden; /* prevent body scroll; cards will scroll internally */
        }

        /* App full-viewport shell */
        .app-shell {
            height: 100vh;
            width: 100vw;
            display: flex;
            flex-direction: column;
        }

        /* Optional top bar (small header) */
        .topbar {
            flex: 0 0 64px;
            display: flex;
            align-items: center;
            padding: 0 20px;
            border-bottom: 1px solid rgba(0,0,0,0.06);
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(4px);
        }

            /* Emphasized top title */
            .topbar .title {
                font-weight: 700;
                font-size: 1.35rem; /* larger */
                color: #0d6efd; /* bootstrap primary */
                letter-spacing: 0.2px;
                margin-right: 12px;
            }

            .topbar .subtitle {
                color: #6c757d;
                font-size: .95rem;
            }

        /* Main area fills remaining space */
        .main {
            flex: 1 1 auto;
            display: flex;
            gap: 14px;
            padding: 14px;
            box-sizing: border-box;
            align-items: stretch;
            width: 100%;
        }

        /* Two columns: each takes 50% of width on desktop, stacks on small screens */
        .col {
            display: flex;
            flex-direction: column;
            gap: 0;
            flex: 1 1 50%;
            min-width: 0; /* important for flex children overflow */
        }

        .card {
            height: 100%;
            display: flex;
            flex-direction: column;
            border: 0;
            box-shadow: 0 8px 26px rgba(18,38,63,0.07);
            background: #ffffff;
            border-radius: 12px;
            overflow: hidden;
        }

        /* Emphasized card header with accent bar */
        .card-header {
            padding: 16px 20px 16px 26px; /* extra left padding to make room for accent */
            background-color: #fbfdff;
            font-size: 1.18rem; /* larger */
            font-weight: 700;
            color: #07204a; /* deep navy for contrast */
            letter-spacing: 0.3px;
            border-bottom: 1px solid rgba(7,32,74,0.06);
            position: relative;
        }
            /* Accent vertical bar on the left of header */
            .card-header::before {
                content: "";
                position: absolute;
                left: 0;
                top: 0;
                bottom: 0;
                width: 6px;
                background: linear-gradient(180deg, #0d6efd 0%, #5aa0ff 100%);
            }
            /* Slightly larger strong inside header if present */
            .card-header strong {
                display: inline-block;
                margin-left: 8px;
                vertical-align: middle;
            }

        /* Scrollable card body */
        .card-body {
            padding: 16px;
            overflow-y: auto;
        }

        /* Make form controls comfortable */
        .form-control, .form-select, textarea {
            min-height: 42px;
        }

        /* Actions pinned to bottom inside booking card (but not fixed to viewport) */
        .card-footer-actions {
            padding: 14px 16px;
            border-top: 1px solid rgba(0,0,0,0.04);
            background: #fff;
        }

        /* Alert area */
        #formAlert .alert {
            margin-bottom: 0;
        }

        /* Small emphasis for section labels inside forms (optional) */
        .section-label {
            font-weight: 600;
            color: #0b2a66;
            font-size: 0.95rem;
        }

        /* Responsive behavior */
        @@media (max-width: 991.98px) {
            .main

        {
            flex-direction: column;
            padding: 10px;
        }

        .col {
            flex: 1 1 auto;
            min-height: 0;
        }

        .topbar {
            flex: 0 0 56px;
        }

        }
    </style>
</head>
<body>
    <div class="app-shell">
        <div class="topbar">
            <div class="title">Nhận phòng - Check-in</div>
            <div class="subtitle">Nhân viên lễ tân cần chú ý các thông tin khi check-in phòng cho khách hàng</div>
        </div>

        <div class="main">
            <!-- Guest Information -->
            <div class="col">
                <div class="card">
                    <div class="card-header">
                        <strong>Thông tin khách</strong>
                    </div>
                    <div class="card-body">
                        <form id="guestForm" class="h-100">
                            <div class="mb-3">
                                <label for="fullName" class="form-label section-label">Họ tên khách <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="fullName" name="fullName" placeholder="Tự động điền từ booking hoặc nhập tay" required>
                                <div class="invalid-feedback">Vui lòng nhập họ tên khách.</div>
                            </div>

                            <div class="mb-3">
                                <label for="idNumber" class="form-label section-label">Số CMND / Passport</label>
                                <input type="text" class="form-control" id="idNumber" name="idNumber" placeholder="Số CMND hoặc Passport">
                                <div class="form-text">Dùng để xác minh danh tính.</div>
                            </div>

                            <div class="row g-3 mb-3">
                                <div class="col-6">
                                    <label for="nationality" class="form-label section-label">Quốc tịch</label>
                                    <input type="text" class="form-control" id="nationality" name="nationality" placeholder="VD: Việt Nam">
                                </div>
                                <div class="col-6">
                                    <label for="dob" class="form-label section-label">Ngày sinh</label>
                                    <input type="date" class="form-control" id="dob" name="dob" max="2100-12-31">
                                </div>
                            </div>

                            <div class="mb-3">
                                <label for="phone" class="form-label section-label">Số điện thoại</label>
                                <input type="tel" class="form-control" id="phone" name="phone" placeholder="+84 9xx xxx xxx">
                            </div>

                            <div class="mb-3">
                                <label for="email" class="form-label section-label">Email</label>
                                <input type="email" class="form-control" id="email" name="email" placeholder="email@domain.com">
                                <div class="form-text">Dùng gửi hóa đơn, xác nhận phòng.</div>
                            </div>

                            <div class="mb-3">
                                <label for="address" class="form-label section-label">Địa chỉ</label>
                                <textarea class="form-control" id="address" name="address" rows="3" placeholder="Địa chỉ để xuất hóa đơn / hồ sơ"></textarea>
                            </div>

                            <div class="mb-3">
                                <label for="guestType" class="form-label section-label">Loại khách</label>
                                <select class="form-select" id="guestType" name="guestType">
                                    <option value="individual">Cá nhân</option>
                                    <option value="company">Công ty</option>
                                    <option value="group">Đoàn</option>
                                    <option value="vip">VIP</option>
                                </select>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Booking Details -->
            <div class="col">
                <div class="card">
                    <div class="card-header">
                        <strong>Thông tin đặt phòng</strong>
                    </div>
                    <div class="card-body">
                        <form id="checkinForm" novalidate>
                            <div class="input-group mb-3">
                                <input type="text" class="form-control" id="bookingCode" placeholder="Mã đặt phòng" aria-label="Booking code">
                                <button class="btn btn-outline-primary" type="button" id="btnLoadBooking">Lấy booking</button>
                            </div>
                            <div id="bookingHint" class="mb-3 text-muted small">Nhập mã đặt phòng rồi bấm "Lấy booking" để tự động điền thông tin </div>

                           

                            <div class="mb-3">
                                <label for="roomNumber" class="form-label section-label">Số phòng</label>
                                <input class="form-select" id="roomNumber" name="roomNumber">   </input>
                                  
                           
                                <div class="form-text">Có thể chọn trong danh sách phòng trống.</div>
                            </div>

                            <div class="mb-3">
                                <label for="numGuests" class="form-label section-label">Số người</label>
                                <input type="number" class="form-control" id="numGuests" name="numGuests" value="1" min="1" max="10">
                            </div>

                            <div class="row g-3 mb-3">
                                <div class="col-6">
                                    <label for="checkinDate" class="form-label section-label">Ngày check-in</label>
                                    <input type="date" class="form-control" id="checkinDate" name="checkinDate" required>
                                    <div class="invalid-feedback">Vui lòng chọn ngày check-in.</div>
                                </div>
                                <div class="col-6">
                                    <label for="checkoutDate" class="form-label section-label">Ngày check-out</label>
                                    <input type="date" class="form-control" id="checkoutDate" name="checkoutDate" required>
                                    <div class="invalid-feedback">Vui lòng chọn ngày check-out.</div>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label for="bookingStatus" class="form-label section-label">Trạng thái đặt phòng</label>
                                <select class="form-select" id="bookingStatus" name="bookingStatus">
                                    <option value="reserved">Đặt trước</option>
                                    <option value="checked-in">Đã check-in</option>
                                    <option value="checked-out">Đã check-out</option>
                                    <option value="cancelled">Hủy</option>
                                </select>
                            </div>

                            <div id="formAlert" class="mt-3" style="display:none;"></div>
                        </form>
                    </div>

                    <div class="card-footer-actions">
                        <div class="d-flex gap-2">
                            <button form="checkinForm" type="submit" class="btn btn-success" id="btnSave">Xác nhận nhận phòng</button>
                            <button type="button" class="btn btn-secondary" id="btnReset">Hủy / Làm lại</button>
                            <div class="ms-auto text-muted small align-self-center">Trung Duc Hotel Luxury</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS + Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Inline JS (client-side logic, demo mocks) -->
    <script>
        (function () {
            // Mock data to simulate backend responses
            const mockBookings = {
                "BK-1001": {
                    guestName: "Nguyễn Văn A",
                    email: "nguyenvana@example.com",
                    phone: "+84 912345678",
                    roomType: "Deluxe",
                    numGuests: 2,
                    checkinDate: todayISO(),
                    checkoutDate: addDaysISO(2)
                },
                "BK-2002": {
                    guestName: "John Doe",
                    email: "john.doe@example.com",
                    phone: "+1 555 234 5678",
                    roomType: "Suite",
                    numGuests: 3,
                    checkinDate: todayISO(),
                    checkoutDate: addDaysISO(4)
                }
            };

            // Mock available rooms by type (in real app this comes from server)
            const availableRooms = {
                "Deluxe": ["101", "102", "103"],
                "Superior": ["201", "202"],
                "Executive": ["301"],
                "Suite": ["401", "402"]
            };

            // Helpers
            function todayISO() {
                return new Date().toISOString().split("T")[0];
            }
            function addDaysISO(days) {
                const d = new Date();
                d.setDate(d.getDate() + days);
                return d.toISOString().split("T")[0];
            }

            // Elements
            const btnLoadBooking = document.getElementById("btnLoadBooking");
            const bookingCodeEl = document.getElementById("bookingCode");
            const fullNameEl = document.getElementById("fullName");
            const emailEl = document.getElementById("email");
            const phoneEl = document.getElementById("phone");
            const roomTypeEl = document.getElementById("roomType");
            const roomNumberEl = document.getElementById("roomNumber");
            const numGuestsEl = document.getElementById("numGuests");
            const checkinDateEl = document.getElementById("checkinDate");
            const checkoutDateEl = document.getElementById("checkoutDate");
            const bookingStatusEl = document.getElementById("bookingStatus");
            const checkinForm = document.getElementById("checkinForm");
            const guestForm = document.getElementById("guestForm");
            const btnReset = document.getElementById("btnReset");
            const formAlert = document.getElementById("formAlert");

            // Initialize dates
            checkinDateEl.value = todayISO();
            checkoutDateEl.value = addDaysISO(1);

            // Populate initial room numbers for default room type
            populateRoomNumbers(roomTypeEl.value);

            // Event: load booking
            btnLoadBooking.addEventListener("click", () => {
                const code = bookingCodeEl.value.trim();
                if (!code) {
                    showAlert("warning", "Vui lòng nhập mã đặt phòng để lấy thông tin.");
                    return;
                }

                // Simulate fetching booking
                const booking = mockBookings[code.toUpperCase()];
                if (!booking) {
                    showAlert("danger", `Không tìm thấy booking "${code}". (Demo chỉ hỗ trợ mã BK-1001 và BK-2002)`);
                    return;
                }

                // Auto-fill fields from booking
                fullNameEl.value = booking.guestName || "";
                emailEl.value = booking.email || "";
                phoneEl.value = booking.phone || "";
                roomTypeEl.value = booking.roomType || roomTypeEl.value;
                numGuestsEl.value = booking.numGuests || numGuestsEl.value;
                checkinDateEl.value = booking.checkinDate || checkinDateEl.value;
                checkoutDateEl.value = booking.checkoutDate || checkoutDateEl.value;
                bookingStatusEl.value = "reserved";

                // Refresh room list based on room type
                populateRoomNumbers(roomTypeEl.value);

                showAlert("success", `Đã nạp thông tin booking ${code.toUpperCase()}. Vui lòng chọn số phòng và kiểm tra lại thông tin.`);
            });

            // Event: when room type changes, update room numbers
            roomTypeEl.addEventListener("change", (e) => {
                populateRoomNumbers(e.target.value);
            });

            // Event: when number of guests changes, we could filter rooms by capacity (demo: no capacity data)
            numGuestsEl.addEventListener("change", () => {
                populateRoomNumbers(roomTypeEl.value);
            });

            // Form submit with client-side validation
            checkinForm.addEventListener("submit", (e) => {
                e.preventDefault();
                clearAlert();

                // Combine HTML5 validation across both forms: check guestForm and checkinForm
                const validGuest = guestForm.checkValidity();
                const validBooking = checkinForm.checkValidity();

                if (!validGuest || !validBooking) {
                    guestForm.classList.add("was-validated");
                    checkinForm.classList.add("was-validated");
                    showAlert("danger", "Có trường bắt buộc chưa nhập hoặc không hợp lệ. Vui lòng kiểm tra form.");
                    return;
                }

                // Additional custom validation: check that room is selected
                if (!roomNumberEl.value) {
                    showAlert("danger", "Vui lòng chọn số phòng trống trước khi xác nhận nhận phòng.");
                    return;
                }

                // Validate check-out date after check-in
                if (checkoutDateEl.value <= checkinDateEl.value) {
                    showAlert("danger", "Ngày check-out phải lớn hơn ngày check-in.");
                    return;
                }

                // Simulate saving check-in (replace with real POST in production)
                const payload = {
                    fullName: fullNameEl.value.trim(),
                    idNumber: document.getElementById("idNumber").value.trim(),
                    nationality: document.getElementById("nationality").value.trim(),
                    dob: document.getElementById("dob").value,
                    phone: phoneEl.value.trim(),
                    email: emailEl.value.trim(),
                    address: document.getElementById("address").value.trim(),
                    guestType: document.getElementById("guestType").value,
                    bookingCode: bookingCodeEl.value.trim(),
                    roomType: roomTypeEl.value,
                    roomNumber: roomNumberEl.value,
                    numGuests: numGuestsEl.value,
                    checkinDate: checkinDateEl.value,
                    checkoutDate: checkoutDateEl.value,
                    bookingStatus: bookingStatusEl.value
                };

                // Demo: show payload (in real app, POST to server)
                console.info("Check-in payload:", payload);
                showAlert("success", `Nhận phòng thành công cho ${payload.fullName}. Mã phòng: ${payload.roomNumber}.`);

                // Reset both forms but keep default dates and repopulate rooms
                guestForm.reset();
                checkinForm.reset();
                guestForm.classList.remove("was-validated");
                checkinForm.classList.remove("was-validated");

                checkinDateEl.value = todayISO();
                checkoutDateEl.value = addDaysISO(1);
                populateRoomNumbers(roomTypeEl.value);
            });

            // Reset button
            btnReset.addEventListener("click", () => {
                guestForm.reset();
                checkinForm.reset();
                guestForm.classList.remove("was-validated");
                checkinForm.classList.remove("was-validated");
                clearAlert();
                checkinDateEl.value = todayISO();
                checkoutDateEl.value = addDaysISO(1);
                populateRoomNumbers(roomTypeEl.value);
            });

            // Utility: populate room numbers select by type
            function populateRoomNumbers(roomType) {
                const list = availableRooms[roomType] || [];
                roomNumberEl.innerHTML = '<option value="">-- Chọn phòng (chỉ hiển thị phòng trống) --</option>';
                list.forEach(r => {
                    const opt = document.createElement("option");
                    opt.value = r;
                    opt.textContent = r;
                    roomNumberEl.appendChild(opt);
                });
            }

            // Utility: show alert in form area
            function showAlert(kind, message) {
                clearAlert();
                const wrapper = document.createElement("div");
                wrapper.className = `alert alert-${kind}`;
                wrapper.role = "alert";
                wrapper.innerHTML = message;
                formAlert.style.display = "block";
                formAlert.appendChild(wrapper);
                // Auto-hide success messages after 5s
                if (kind === "success") {
                    setTimeout(() => {
                        clearAlert();
                    }, 5000);
                }
            }

            function clearAlert() {
                formAlert.style.display = "none";
                formAlert.innerHTML = "";
            }
        })();
    </script>
</body>
</html>